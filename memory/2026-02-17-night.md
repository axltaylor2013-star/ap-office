# 2026-02-17 Night - CASTING ERROR FINALLY FIXED!

## The Real Root Cause
After extensive debugging, found the true source of "Unable to cast value to Object" errors:

**Problem:** Multiple server scripts calling `InventoryUpdate` RemoteEvent **inconsistently**:
- Some scripts: `invRemote:FireClient(player, data.Inventory)` ✅
- Other scripts: `invRemote:FireClient(player)` ❌ (missing inventory data)

When client expects inventory array but gets `nil` → casting error.

## Scripts Fixed (7 total)
1. SkillManager.server.lua
2. HotbarHandler.server.lua  
3. DropHandler.server.lua
4. ShopManager.server.lua (helper function)
5. FletchingManager.server.lua (4 calls)
6. SmithingManager.server.lua (4 calls)

## The Fix Pattern
**Before:** `invRemote:FireClient(player)`
**After:** 
```lua
local data = DataManager.GetData(player)
if data and data.Inventory then
    invRemote:FireClient(player, data.Inventory)
end
```

## Previous Wrong Diagnoses
- Bobbing item animations (fixed those too, but wasn't root cause)
- Camera shake system (disabled, but wasn't the issue)
- UI script problems (red herring)

## Lesson Learned
**RemoteEvent parameter consistency is CRITICAL.** Any mismatch between server FireClient calls and client OnClientEvent handlers causes casting errors that can crash entire game systems.

**Always validate:**
1. All FireClient calls use same parameter signature
2. Client expects exactly what server sends
3. Use type checking: `typeof(data) == "table"`

This error was happening **every time someone used inventory/gathering/shop systems** — explains why it was so frequent and why UI kept disappearing (scripts were crashing continuously).

Game should now be completely stable.